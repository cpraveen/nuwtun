C        Generated by TAPENADE     (INRIA, Tropics team)
C  Tapenade - Version 2.1.3 (r429) - Mon Sep 12 10:15:34 2005
C  
C  Differentiation of cvtc2p in reverse (adjoint) mode:
C   gradient, with respect to input variables: qc qp
C   of linear combination of output variables: qc qp
      SUBROUTINE CVTC2P_Q(idim, jdim, kdim, q, qb)
      include '../../src-flo/header/common.h'
      DIMENSION Q  (0:JDIM+2, 0:KDIM+2, 0:IDIM+2, NQ),
     1          QB (0:JDIM+2, 0:KDIM+2, 0:IDIM+2, NQ)
      INTEGER i, j, k
      REAL QC(NQ), qpb(NQ), tempb, tempb0, tempb1, tempb2

      DO i=idim,2,-1
        DO k=kdim,2,-1
          DO j=jdim,2,-1
            QPB(:) = QB(J,K,I,:)
            QB(J,K,I,:) = 0.0E0
            QC(1) = Q(J,K,I,1)
            QC(2) = Q(J,K,I,2)*Q(J,K,I,1)
            QC(3) = Q(J,K,I,3)*Q(J,K,I,1)
            QC(4) = Q(J,K,I,4)*Q(J,K,I,1)
            QC(5) = Q(J,K,I,5)/GAMM1 + 0.5*Q(J,K,I,1)*(
     1              Q(J,K,I,2)**2 + Q(J,K,I,3)**2 + Q(J,K,I,4)**2 )
            tempb = -(0.5*gamm1*qpb(5)/qc(1))
            QB(j, k, i, 5) = QB(j, k, i, 5) + gamm1*qpb(5)
            QB(j, k, i, 2) = QB(j, k, i, 2) + 2*qc(2)*tempb
            QB(j, k, i, 3) = QB(j, k, i, 3) + 2*qc(3)*tempb
            QB(j, k, i, 4) = QB(j, k, i, 4) + 2*qc(4)*tempb
            QB(j, k, i, 1) = QB(j, k, i, 1) - (qc(2)**2 + qc(3)**2 +
     +                       qc(4)**2)*tempb/qc(1)
            tempb0 = qpb(4)/qc(1)
            QB(j, k, i, 4) = QB(j, k, i, 4) + tempb0
            QB(j, k, i, 1) = QB(j, k, i, 1) - qc(4)*tempb0/qc(1)
            tempb1 = qpb(3)/qc(1)
            QB(j, k, i, 3) = QB(j, k, i, 3) + tempb1
            QB(j, k, i, 1) = QB(j, k, i, 1) - qc(3)*tempb1/qc(1)
            tempb2 = qpb(2)/qc(1)
            QB(j, k, i, 2) = QB(j, k, i, 2) + tempb2
            QB(j, k, i, 1) = QB(j, k, i, 1) + qpb(1) - 
     +                       qc(2)*tempb2/qc(1)
          ENDDO
        ENDDO
      ENDDO
      END
